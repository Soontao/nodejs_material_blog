<!DOCTYPE html>
<html lang="zh-CN">
<%- include head %>

    <body>
        <%- include header %>
            <div class="container">
                <div class="row " style="padding-top: 150px;padding-bottom: 150px;">
                    <div class="col s12" style="padding-left: 20%;padding-right: 20%;">
                        <form id="login" action="post">
                            <div class="row">
                                <div class="input-field col s12">
                                    <input name="username" id="username" type="text" class="validate"></input>
                                    <label for="username ">Username</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12">
                                    <input id="password" type="password" class="validate"></input>
                                    <label for="password">Password</label>
                                </div>
                            </div>
                            <div class="row center">
                                <button class="btn waves-effect waves-light" type="submit">Login
                            </button>
                                <a href="/register" class="btn waves-effect waves-light" name="action">
                                    Register
                                </a>
                            </div>
                        </form>

                        <script>
                            $("#login").submit(e => {
                                e.preventDefault();
                                login();
                            });

                            function login() {
                                $.post("/login", {
                                    username: $("#username").val(),
                                    password: $("#password").val()
                                }, function(data, status) {
                                    if (data == "success") {
                                        onclick = Materialize.toast('登录成功', 800, '', function() {
                                            window.location = "/admin/overview";
                                        });
                                    } else {
                                        Materialize.toast('登录失败,请检查用户名和密码', 800)
                                    }
                                });
                            }
                        </script>
                    </div>
                </div>
            </div>
            <%- include footer %>
    </body>

</html>